<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Match Tracker</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json" />
    
    <!-- iOS Safari PWA support -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Match Tracker" />
    <link rel="apple-touch-icon" href="icons/icon-192x192.png" />
    
    <!-- Theme color for browser chrome -->
    <meta name="theme-color" content="#111827" />
    <meta name="msapplication-TileColor" content="#111827" />
    
    <!-- Local Tailwind CSS for offline functionality -->
    <link rel="stylesheet" href="tailwind-minimal.css" />
    <!-- Custom fallback styles -->
    <link rel="stylesheet" href="styles.css" />
  </head>
    <body class="bg-gray-900 text-gray-100 min-h-screen">
    <!-- Use the same background colour as the rest of the app for a seamless header.  Reduce padding to
         free vertical space and remove the drop shadow. -->
    <!-- Hide the header by default; it will be shown only on match details view via JavaScript. -->
    <header class="bg-gray-900 text-gray-100 px-4 py-2 text-center" style="display:none;">
      <!-- The app title will be updated dynamically to show the competition name when viewing a match -->
      <!-- The app title displays the competition name when viewing a match. We use a slightly larger font for better hierarchy -->
      <!-- Make the title slightly smaller to provide more space for other elements. -->
      <h1 id="app-title" class="text-xl font-bold tracking-wide">Match Tracker</h1>
    </header>
    <main class="max-w-4xl mx-auto p-4">
      <!-- Match list view -->
      <section id="match-list-view" class="view">
        <!-- Title for the match list.  Use a larger font to mirror the native app and remove "Your" to
             simply label it as Matches. -->
        <!-- Use a large heading for the match list to mirror the native app.  The title is bold and
             slightly larger than the default header to help it stand out. -->
        <!-- Header row for the match list: show the title on the left and an add
             match button next to it.  Align items to the start so the button sits
             beside the heading. -->
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-3xl font-bold">Matches</h2>
          <div class="flex items-center">
            <!-- Data Management button -->
            <button id="data-management-btn" class="cursor-pointer mr-3" title="Export/Import Data">
              <img src="icons/export.svg" alt="Export/Import Data" class="w-8 h-8" />
            </button>
            <!-- Add Match button aligned to the right of the header -->
            <button id="add-match-btn" class="cursor-pointer" title="Add Match">
              <img src="icons/plus.svg" alt="Add Match" class="w-8 h-8" />
            </button>
          </div>
        </div>
        <div id="match-list" class="match-list space-y-2"></div>
      </section>

      <!-- Match form view (create/edit) -->
      <section id="match-form-view" class="view" style="display: none;">
        <!-- Top bar for the match form: Cancel on the left and Done on the right.  The
             Cancel button calls cancelMatchForm() and the Done button submits the form. -->
        <!-- Top bar: match the Cancel/Done style used on the player edit screen.  Plain text links with blue
             colour provide a lightweight navigation style. -->
        <div class="flex justify-between items-center my-2">
          <button type="button" id="cancel-form-top" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Cancel">Cancel</button>
          <h2 id="form-title" class="text-xl font-semibold">New Match</h2>
          <button type="submit" form="match-form" id="save-form-top" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Done">Done</button>
        </div>
        <form id="match-form" class="form space-y-0">
          <!-- Competition -->
          <div class="form-row flex flex-col mb-2">
            <label for="competition" class="mb-1">Competition</label>
            <input type="text" id="competition" name="competition" placeholder="Competition" class="p-2 border bg-gray-700 text-gray-100 border-gray-600" />
          </div>
          <!-- Team 1 -->
          <div class="form-row flex flex-col mb-2">
            <label for="team1" class="mb-1">Team 1 Name</label>
            <input type="text" id="team1" name="team1" placeholder="Team 1 Name" required class="p-2 border bg-gray-700 text-gray-100 border-gray-600" />
          </div>
          <!-- Team 2 -->
          <div class="form-row flex flex-col mb-2">
            <label for="team2" class="mb-1">Team 2 Name</label>
            <input type="text" id="team2" name="team2" placeholder="Team 2 Name" required class="p-2 border bg-gray-700 text-gray-100 border-gray-600" />
          </div>
          <!-- Date -->
          <div class="form-row flex flex-col mb-2">
            <label for="dateTime" class="mb-1">Date</label>
            <!-- Use a date picker instead of a datetime picker.  Users only need to specify the day and
                 not the exact time. -->
            <input type="date" id="dateTime" name="dateTime" class="p-2 border bg-gray-700 text-gray-100 border-gray-600" />
          </div>
          <!-- Match Type -->
          <div class="form-row flex flex-col mb-2">
            <label for="matchType" class="mb-1">Match Type</label>
            <select id="matchType" name="matchType" class="p-2 border bg-gray-700 text-gray-100 border-gray-600">
              <option value="football">Football</option>
              <option value="hurling">Hurling</option>
              <option value="ladiesFootball">Ladies Football</option>
              <option value="camogie">Camogie</option>
            </select>
          </div>
          <!-- Venue -->
          <div class="form-row flex flex-col mb-2">
            <label for="venue" class="mb-1">Venue</label>
            <input type="text" id="venue" name="venue" placeholder="Venue" class="p-2 border bg-gray-700 text-gray-100 border-gray-600" />
          </div>
          <!-- Referee -->
          <div class="form-row flex flex-col mb-2">
            <label for="referee" class="mb-1">Referee</label>
            <input type="text" id="referee" name="referee" placeholder="Referee" class="p-2 border bg-gray-700 text-gray-100 border-gray-600" />
          </div>
          <!-- Removed half length and extra half length inputs as these durations are not used in the current
               implementation.  Users no longer need to specify playing or extra‑time durations. -->
          <!-- Bottom buttons removed in favour of top Cancel/Done bar. -->
        </form>
      </section>

      <!-- Match details view -->
      <section id="match-details-view" class="view" style="display: none;">
        <!-- Top bar with back button, timer (with period) and edit match button -->
        <div class="flex justify-between items-center mt-1 mb-1">
          <!-- Back button with icon -->
          <button id="back-to-list-btn" class="cursor-pointer" title="Back to Matches">
            <img src="icons/back.svg" alt="Back" class="w-8 h-8" />
          </button>
          <div class="flex items-center">
            <!-- Share button -->
            <button id="share-match-btn" class="cursor-pointer mr-3" title="Share Match">
              <img src="icons/share.svg" alt="Share" class="w-8 h-8" />
            </button>
            <!-- Stats button -->
            <button id="view-stats-btn" class="cursor-pointer mr-3" title="View Statistics">
              <img src="icons/stats.svg" alt="Statistics" class="w-8 h-8" />
            </button>
            <!-- Edit match button with pencil icon remains on the far right -->
            <button id="edit-match-btn" class="cursor-pointer" title="Edit Match">
              <img src="icons/edit.svg" alt="Edit" class="w-8 h-8" />
            </button>
          </div>
        </div>
        <!-- Timer row: place start/end button to the left of the timer and pause/resume on the right.  The
             period label sits above the timer display to mirror the iOS layout. -->
        <!-- Spread the timer controls across the full width.  The start/end button sits on the left,
             the period/time display stays centered, and the pause/resume controls align on the right. -->
        <!-- Maintain a minimum height even when control buttons are hidden so the scoreboard does not shift upward. -->
        <div class="relative flex items-center mt-4 mb-2 w-full min-h-[3.5rem]">
          <!-- Start/end half button with confirmation modal -->
          <button id="end-period-btn" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" style="display:none;">
            <span id="end-period-label">Start Half</span>
          </button>
          <!-- Center the period and timer absolutely so it stays centred regardless of button widths -->
          <div class="flex flex-col items-center absolute left-1/2 transform -translate-x-1/2">
            <!-- Current period name -->
            <div id="period-display" class="text-sm font-semibold tracking-wide"></div>
            <!-- Timer display; prominent font size -->
            <div id="timer-display" class="text-3xl font-mono font-bold">00:00</div>
          </div>
          <!-- Timer control buttons.  Only one of these (start, pause, resume) is visible at a time.  They
               are placed to the right of the timer to match the iOS layout. -->
          <div class="flex items-center space-x-2 ml-auto">
            <button id="pause-timer-btn" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" style="display:none;" title="Pause">
              Pause
            </button>
            <button id="resume-timer-btn" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" style="display:none;" title="Resume">
              Resume
            </button>
          </div>
        </div>
        <!-- Timer controls moved directly below the match title so the clock is prominently displayed at the top
             of the screen. -->
        <!-- Team cards styled similar to native app screenshot -->
        <div id="team-cards" class="space-y-2 mt-0 mb-2">
          <!-- Team 1 Card -->
          <div id="team1-card" class="team-card relative bg-gray-800 border border-gray-700 rounded-lg shadow p-4 text-gray-100">
            <div class="card-header flex justify-between items-center mb-0">
              <button class="team-event-btn" data-team="team1" title="Add Event">
                <img src="icons/plus.svg" alt="Add Event" class="w-8 h-8" />
              </button>
              <h3 class="team-name text-xl font-semibold"></h3>
              <button class="team-edit-btn" data-team="team1" title="Edit Players">
                <img src="icons/players.svg" alt="Edit Players" class="w-8 h-8" />
              </button>
            </div>
            <!-- Combine the score display and scoring buttons into a single row.  The green goal flag sits to the
                 left of the central score, while the orange two‑pointer (when applicable) and white point flags
                 sit to the right.  This layout mirrors the native app screenshot where the score is centered
                 between its scoring controls. -->
            <div class="score-row relative flex items-center mt-1 mb-2">
              <!-- Goal flag anchored on the left side -->
              <button class="team-goal-btn w-12 h-12 flex items-center justify-center" data-team="team1" title="Goal">
                <img src="icons/greenflag.svg" alt="Goal" class="w-10 h-10" />
              </button>
              <!-- Right‑side flag buttons grouped together -->
              <div class="flag-buttons flex space-x-2 ml-auto">
                <button class="team-two-pointer-btn w-12 h-12 flex items-center justify-center hidden" data-team="team1" title="2 Pointer">
                  <img src="icons/orangeflag.svg" alt="2 Pointer" class="w-10 h-10" />
                </button>
                <button class="team-point-btn w-12 h-12 flex items-center justify-center" data-team="team1" title="Point">
                  <img src="icons/whiteflag.svg" alt="Point" class="w-10 h-10" />
                </button>
              </div>
              <!-- Scoreboard absolutely centered within the row.  Pointer events are disabled so
                   clicking the flags still works. -->
              <div class="score-display absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                <div class="flex items-baseline">
                  <span class="score-goals text-5xl font-bold"></span>
                  <span class="mx-1 text-4xl font-bold">-</span>
                  <span class="score-points text-5xl font-bold"></span>
                </div>
                <span class="score-total text-xs text-gray-400 mt-1"></span>
              </div>
            </div>
          </div>
        <!-- Score event modal -->
        <!--
          This modal is displayed when a user taps the goal or point button on a team card.
          Instead of immediately logging a default shot, the app prompts the user to
          select the shot type (e.g. free, penalty) and the player responsible for
          the score.  The modal is styled to resemble the native app screenshot: a header
          with an icon and the score type, a meta line showing team/time/period
          information, side‑by‑side lists for shot types and players, an optional notes
          field, and a single Done button.  The modal remains hidden by default and
          is shown via JavaScript.
        -->
        <div id="score-event-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
          <div class="bg-gray-800 text-gray-100 p-4 border border-gray-700 w-11/12 max-w-xl h-[85vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-2">
              <button id="score-modal-cancel" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Cancel">Cancel</button>
              <h3 id="score-modal-title" class="text-lg font-bold flex items-center space-x-2">
                <!-- Icon and label inserted dynamically -->
              </h3>
              <button id="score-modal-done" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Done">Done</button>
            </div>
            <div class="flex space-x-2 mb-3" style="max-height: 60vh;">
              <!-- Shot type selection on the left.  This column remains static while
                   the player column scrolls -->
              <div id="score-type-list" class="flex-1 space-y-1">
                <!-- Items inserted by JS -->
              </div>
              <!-- Player selection on the right with fixed header -->
              <div class="flex-1 flex flex-col">
                <div id="score-player-header" class="text-sm font-medium text-gray-300 mb-2">Player</div>
                <div id="score-player-list" class="space-y-1 overflow-y-auto border border-gray-600 rounded flex-1" style="max-height: 60vh;">
                  <!-- Items inserted by JS -->
                </div>
              </div>
            </div>
            <div class="form-row flex flex-col mb-3">
              <label for="score-notes" class="mb-1 text-sm text-gray-300">Optional notes</label>
              <textarea id="score-notes" class="p-2 border bg-gray-700 text-gray-100 border-gray-600 h-12 text-sm"></textarea>
            </div>
            <!-- There is no separate Save button at the bottom of the scoring modal.  The top Done button
                 handles saving the event and closing the modal. -->
          </div>
        </div>

        <!-- Foul event modal -->
        <div id="foul-event-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
          <div class="bg-gray-800 text-gray-100 p-4 border border-gray-700 w-11/12 max-w-xl h-[85vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-2">
              <button id="foul-modal-cancel" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Cancel">Cancel</button>
              <h3 id="foul-modal-title" class="text-lg font-bold flex items-center space-x-2">
                <img src="icons/foul.svg" alt="Foul" class="w-6 h-6" />
                <span>Foul</span>
              </h3>
              <button id="foul-modal-done" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Done">Done</button>
            </div>
            
            <!-- Team name and time info -->
            <div id="foul-event-meta" class="text-sm text-gray-400 mb-6 p-3 bg-gray-700 border border-gray-600 rounded">
              <!-- Team name, time and period info will be populated here -->
            </div>
            
            <div class="flex space-x-2 mb-3" style="max-height: 60vh;">
              <!-- Foul type and card selection on the left -->
              <div class="flex-1 space-y-2">
                <!-- Foul Type Section -->
                <div class="space-y-1">
                  <div class="text-sm font-medium text-gray-300 mb-2">Foul Type</div>
                  <button id="foul-type-free" class="foul-type-option w-full p-2 bg-gray-700 text-gray-100 border border-gray-600 rounded text-left" data-foul-type="free">
                    <div class="flex items-center space-x-2">
                      <div class="w-4 h-4 bg-blue-500 flex items-center justify-center text-xs font-bold">F</div>
                      <span>Free</span>
                    </div>
                  </button>
                  <button id="foul-type-penalty" class="foul-type-option w-full p-2 bg-gray-700 text-gray-100 border border-gray-600 rounded text-left" data-foul-type="penalty">
                    <div class="flex items-center space-x-2">
                      <div class="w-4 h-4 bg-orange-500 flex items-center justify-center text-xs font-bold">P</div>
                      <span>Penalty</span>
                    </div>
                  </button>
                </div>
                
                <!-- Card Section -->
                <div class="space-y-1">
                  <div class="text-sm font-medium text-gray-300 mb-2">Card</div>
                  <button id="card-type-none" class="card-type-option w-full p-2 bg-blue-600 text-white border border-blue-600 rounded text-left" data-card-type="none">
                    <div class="flex items-center space-x-2">
                      <div class="w-4 h-4 bg-gray-500"></div>
                      <span>None</span>
                    </div>
                  </button>
                  <button id="card-type-yellow" class="card-type-option w-full p-2 bg-gray-700 text-gray-100 border border-gray-600 rounded text-left" data-card-type="yellow">
                    <div class="flex items-center space-x-2">
                      <div class="w-4 h-4 bg-yellow-400"></div>
                      <span>Yellow Card</span>
                    </div>
                  </button>
                  <button id="card-type-red" class="card-type-option w-full p-2 bg-gray-700 text-gray-100 border border-gray-600 rounded text-left" data-card-type="red">
                    <div class="flex items-center space-x-2">
                      <div class="w-4 h-4 bg-red-500"></div>
                      <span>Red Card</span>
                    </div>
                  </button>
                  <button id="card-type-black" class="card-type-option w-full p-2 bg-gray-700 text-gray-100 border border-gray-600 rounded text-left" data-card-type="black">
                    <div class="flex items-center space-x-2">
                      <div class="w-4 h-4 bg-gray-900 border border-gray-600"></div>
                      <span>Black Card</span>
                    </div>
                  </button>
                </div>
              </div>
              
              <!-- Player selection on the right with fixed header -->
              <div class="flex-1 flex flex-col">
                <div id="foul-player-header" class="text-sm font-medium text-gray-300 mb-2">Player</div>
                <div id="foul-player-list" class="space-y-1 overflow-y-auto border border-gray-600 rounded flex-1" style="max-height: 60vh;">
                  <!-- Items inserted by JS -->
                </div>
              </div>
            </div>
            
            <div class="form-row flex flex-col mb-3">
              <label for="foul-notes" class="mb-1 text-sm text-gray-300">Optional notes</label>
              <textarea id="foul-notes" class="p-2 border bg-gray-700 text-gray-100 border-gray-600 rounded h-12 text-sm"></textarea>
            </div>
          </div>
        </div>

        <!-- Kickout event modal -->
        <div id="kickout-event-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
          <div class="bg-gray-800 text-gray-100 p-4 border border-gray-700 w-11/12 max-w-xl h-[85vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-2">
              <button id="kickout-modal-cancel" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Cancel">Cancel</button>
              <h3 id="kickout-modal-title" class="text-lg font-bold flex items-center space-x-2">
                <img src="icons/kickout.svg" alt="Kickout" class="w-6 h-6" />
                <span>Kickout</span>
              </h3>
              <button id="kickout-modal-done" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Done">Done</button>
            </div>
            
            <!-- Team name and time info -->
            <div id="kickout-event-meta" class="text-sm text-gray-400 mb-6 p-3 bg-gray-700 border border-gray-600 rounded">
              <!-- Team name, time and period info will be populated here -->
            </div>
            
            <div class="flex space-x-2 mb-3" style="max-height: 60vh;">
              <!-- Kickout outcome selection on the left -->
              <div class="flex-1 space-y-2">
                <div class="space-y-1">
                  <div class="text-sm font-medium text-gray-300 mb-2">Outcome</div>
                  <button id="kickout-outcome-won" class="kickout-outcome-option w-full p-2 bg-blue-600 text-white border border-blue-600 rounded text-left" data-kickout-outcome="won">
                    <div class="flex items-center space-x-2">
                      <div class="w-4 h-4 bg-green-500 flex items-center justify-center text-xs font-bold">✓</div>
                      <span>Won Own Kickout</span>
                    </div>
                  </button>
                  <button id="kickout-outcome-lost" class="kickout-outcome-option w-full p-2 bg-gray-700 text-gray-100 border border-gray-600 rounded text-left" data-kickout-outcome="lost">
                    <div class="flex items-center space-x-2">
                      <div class="w-4 h-4 bg-red-500 flex items-center justify-center text-xs font-bold">✗</div>
                      <span>Lost Own Kickout</span>
                    </div>
                  </button>
                </div>
              </div>
              
              <!-- Player selection on the right with fixed header -->
              <div class="flex-1 flex flex-col">
                <div id="kickout-player-header" class="text-sm font-medium text-gray-300 mb-2">Player</div>
                <div id="kickout-player-list" class="space-y-1 overflow-y-auto border border-gray-600 rounded flex-1" style="max-height: 60vh;">
                  <!-- Items inserted by JS -->
                </div>
              </div>
            </div>
            
            <div class="form-row flex flex-col mb-3">
              <label for="kickout-notes" class="mb-1 text-sm text-gray-300">Optional notes</label>
              <textarea id="kickout-notes" class="p-2 border bg-gray-700 text-gray-100 border-gray-600 rounded h-12 text-sm"></textarea>
            </div>
          </div>
        </div>

        <!-- Substitution event modal -->
        <div id="substitution-event-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
          <div class="bg-gray-800 text-gray-100 p-4 border border-gray-700 w-11/12 max-w-xl h-[85vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-2">
              <button id="substitution-modal-cancel" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Cancel">Cancel</button>
              <h3 id="substitution-modal-title" class="text-lg font-bold flex items-center space-x-2">
                <img src="icons/sub.svg" alt="Substitution" class="w-6 h-6" />
                <span>Substitution</span>
              </h3>
              <button id="substitution-modal-done" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Done">Done</button>
            </div>
            
            <!-- Team name and time info -->
            <div id="substitution-event-meta" class="text-sm text-gray-400 mb-6 p-3 bg-gray-700 border border-gray-600 rounded">
              <!-- Team name, time and period info will be populated here -->
            </div>
            
            <div class="flex space-x-2 mb-3" style="max-height: 60vh;">
              <!-- Player Off selection on the left -->
              <div class="flex-1 flex flex-col">
                <div id="substitution-player-off-header" class="text-sm font-medium text-gray-300 mb-2">Player Off</div>
                <div id="substitution-player-off-list" class="space-y-1 overflow-y-auto border border-gray-600 rounded flex-1" style="max-height: 60vh;">
                  <!-- Items inserted by JS -->
                </div>
              </div>
              
              <!-- Player On selection on the right -->
              <div class="flex-1 flex flex-col">
                <div id="substitution-player-on-header" class="text-sm font-medium text-gray-300 mb-2">Player On</div>
                <div id="substitution-player-on-list" class="space-y-1 overflow-y-auto border border-gray-600 rounded flex-1" style="max-height: 60vh;">
                  <!-- Items inserted by JS -->
                </div>
              </div>
            </div>
            
            <div class="form-row flex flex-col mb-3">
              <label for="substitution-notes" class="mb-1 text-sm text-gray-300">Optional notes</label>
              <textarea id="substitution-notes" class="p-2 border bg-gray-700 text-gray-100 border-gray-600 rounded h-12 text-sm"></textarea>
            </div>
          </div>
        </div>

        <!-- Note event modal -->
        <div id="note-event-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
          <div class="bg-gray-800 text-gray-100 p-4 border border-gray-700 w-11/12 max-w-xl h-[85vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-2">
              <button id="note-modal-cancel" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Cancel">Cancel</button>
              <h3 id="note-modal-title" class="text-lg font-bold flex items-center space-x-2">
                <img src="icons/note.svg" alt="Note" class="w-6 h-6" />
                <span>Note</span>
              </h3>
              <button id="note-modal-done" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Done">Done</button>
            </div>
            
            <!-- Team name and time info -->
            <div id="note-event-meta" class="text-sm text-gray-400 mb-6 p-3 bg-gray-700 border border-gray-600 rounded">
              <!-- Team name, time and period info will be populated here -->
            </div>
            
            <div class="form-row flex flex-col mb-3">
              <label for="note-text" class="mb-1 text-sm text-gray-300">Enter note details</label>
              <textarea id="note-text" class="p-2 border bg-gray-700 text-gray-100 border-gray-600 rounded h-32 text-sm" placeholder="Enter note details"></textarea>
            </div>
          </div>
        </div>

          <!-- Team 2 Card -->
          <div id="team2-card" class="team-card relative bg-gray-800 border border-gray-700 rounded-lg shadow p-4 text-gray-100">
            <div class="card-header flex justify-between items-center mb-0">
              <button class="team-event-btn" data-team="team2" title="Add Event">
                <img src="icons/plus.svg" alt="Add Event" class="w-8 h-8" />
              </button>
              <h3 class="team-name text-xl font-semibold"></h3>
              <button class="team-edit-btn" data-team="team2" title="Edit Players">
                <img src="icons/players.svg" alt="Edit Players" class="w-8 h-8" />
              </button>
            </div>
            <!-- Combine the score display and scoring buttons into a single row.  The goal flag sits
                 to the left of the central score, while the two‑pointer (when applicable) and
                 white point flags sit to the right.  This mirrors the layout for team 1. -->
            <div class="score-row relative flex items-center mt-1 mb-2">
              <!-- Goal flag anchored on the left side -->
              <button class="team-goal-btn w-12 h-12 flex items-center justify-center" data-team="team2" title="Goal">
                <img src="icons/greenflag.svg" alt="Goal" class="w-10 h-10" />
              </button>
              <!-- Right‑side flag buttons grouped together -->
              <div class="flag-buttons flex space-x-2 ml-auto">
                <button class="team-two-pointer-btn w-12 h-12 flex items-center justify-center hidden" data-team="team2" title="2 Pointer">
                  <img src="icons/orangeflag.svg" alt="2 Pointer" class="w-10 h-10" />
                </button>
                <button class="team-point-btn w-12 h-12 flex items-center justify-center" data-team="team2" title="Point">
                  <img src="icons/whiteflag.svg" alt="Point" class="w-10 h-10" />
                </button>
              </div>
              <!-- Scoreboard absolutely centered within the row.  Pointer events are disabled so
                   clicking the flags still works. -->
              <div class="score-display absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                <div class="flex items-baseline">
                  <span class="score-goals text-5xl font-bold"></span>
                  <span class="mx-1 text-4xl font-bold">-</span>
                  <span class="score-points text-5xl font-bold"></span>
                </div>
                <span class="score-total text-xs text-gray-400 mt-1"></span>
              </div>
            </div>
          </div>
        </div>

        <!-- The old quick scoring button group and central edit players button were removed.  Each
          team card now includes its own goal/point and edit icons. -->
        <!-- Last event display and toggle for full list -->
        <div id="last-event-display" class="bg-gray-800 border border-gray-700 rounded p-4 mt-4 mb-4 hidden cursor-pointer text-gray-100">
          <!-- This content will be populated dynamically -->
        </div>

        <!-- Modals for adding an event and viewing the full events list -->
        <!-- Add Event Modal -->
        <div id="add-event-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
          <div class="bg-gray-800 text-gray-100 p-4 border border-gray-700 w-11/12 max-w-xl h-[85vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-2">
              <button id="add-event-modal-cancel" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Cancel">Cancel</button>
              <h3 class="text-lg font-bold">Add Event</h3>
              <button id="add-event-modal-done" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Add">Add</button>
            </div>
            <div class="form-row flex flex-col mb-2">
              <label for="event-type" class="mb-1">Event Type</label>
              <select id="event-type" name="event-type" class="p-2 border bg-gray-700 text-gray-100 border-gray-600 w-full">
                <option value="shot">Shot</option>
                <option value="foulConceded">Foul Conceded</option>
                <option value="kickout">Kick‑out</option>
                <option value="substitution">Substitution</option>
                <option value="note">Note</option>
              </select>
            </div>
            <div id="event-fields" class="space-y-2"></div>
          </div>
        </div>
        <!-- Events List Modal -->
        <div id="events-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
          <div class="bg-gray-800 text-gray-100 border border-gray-700 w-11/12 max-w-md max-h-[80vh] flex flex-col">
            <!-- Sticky Header -->
            <div class="flex-shrink-0 sticky top-0 bg-gray-800 border-b border-gray-700">
              <div class="flex justify-between items-center p-4">
                <h3 class="font-semibold">Events</h3>
                <!-- Use a "Done" button for closing the events list to match
                     the other modals and maintain consistent navigation.  It
                     omits the X icon and relies on the blue text styling. -->
                <button id="close-events-modal-btn" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Done">
                  Done
                </button>
              </div>
            </div>
            
            <!-- Scrollable Content -->
            <div class="flex-1 overflow-y-auto p-4">
              <!-- The events list will be populated dynamically.  Remove the divide classes
                   so our card styling (margins and borders) stand alone without
                   extra lines. -->
              <ul id="events-list" class="events-list"></ul>
            </div>
          </div>
        </div>

        <!-- Edit event modal overlay -->
        <div id="edit-event-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
          <div class="bg-gray-800 text-gray-100 p-4 border border-gray-700 w-11/12 max-w-md">
            <h3 class="text-lg font-bold mb-2">Edit Event</h3>
            <div id="edit-event-fields" class="space-y-2"></div>
            <div class="flex justify-end mt-4 space-x-2">
              <button id="save-edit-event-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center space-x-1" title="Save">
                <span class="text-lg">✅</span>
                <span>Save</span>
              </button>
              <button id="cancel-edit-event-btn" class="bg-gray-600 hover:bg-gray-700 text-gray-100 px-4 py-2 rounded flex items-center space-x-1" title="Cancel">
                <span class="text-lg">✖️</span>
                <span>Cancel</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Period action confirmation modal -->
        <div id="period-confirm-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
          <div class="bg-gray-800 text-gray-100 p-6 border border-gray-700 w-11/12 max-w-sm">
            <h3 id="period-confirm-title" class="text-lg font-bold mb-4 text-center">Confirm Action</h3>
            <p id="period-confirm-message" class="text-center mb-6 text-gray-300">Are you sure you want to start the half?</p>
            <div class="flex justify-center space-x-4">
              <button id="period-confirm-yes" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded font-semibold">
                Yes
              </button>
              <button id="period-confirm-no" class="bg-gray-600 hover:bg-gray-700 text-gray-100 px-6 py-2 rounded font-semibold">
                Cancel
              </button>
            </div>
          </div>
        </div>

        <!-- Event type selection modal -->
        <div id="event-type-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
          <div class="bg-gray-800 text-gray-100 p-6 rounded-xl shadow-xl w-11/12 max-w-lg">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-xl font-bold">Add Event</h3>
              <button id="event-type-modal-cancel" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Cancel">Cancel</button>
            </div>
            <div id="event-type-meta" class="text-sm text-gray-400 mb-6 p-3 bg-gray-700 border border-gray-600 rounded">
              <!-- Team name, time and period info will be populated here -->
            </div>
            <div class="grid grid-cols-2 gap-4 mb-6">
              <button class="event-type-option" data-event-type="miss">
                <img src="icons/missbutton.svg" alt="Miss" class="w-full h-auto" />
              </button>
              <button class="event-type-option" data-event-type="foul">
                <img src="icons/foulbutton.svg" alt="Foul" class="w-full h-auto" />
              </button>
              <button class="event-type-option" data-event-type="kickout">
                <img src="icons/kickoutbutton.svg" alt="Kickout" class="w-full h-auto" />
              </button>
              <button class="event-type-option" data-event-type="sub">
                <img src="icons/subbutton.svg" alt="Sub" class="w-full h-auto" />
              </button>
              <button class="event-type-option" data-event-type="note">
                <img src="icons/notebutton.svg" alt="Note" class="w-full h-auto" />
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- Data Management Modal -->
      <div id="data-management-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-gray-800 text-gray-100 p-4 border border-gray-700 w-11/12 max-w-md">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-bold">Data Management</h3>
            <button id="close-data-management-btn" class="text-blue-500 hover:text-blue-400 font-semibold">Close</button>
          </div>
          
          <!-- Export Section -->
          <div class="mb-6">
            <h4 class="font-semibold mb-2">Export Data</h4>
            <p class="text-sm text-gray-300 mb-3">Backup all your matches to a JSON file</p>
            <button id="export-data-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded mb-2">
              Export All Matches
            </button>
            <div id="export-status" class="text-sm text-gray-400"></div>
          </div>
          
          <!-- Import Section -->
          <div class="mb-4">
            <h4 class="font-semibold mb-2">Import Data</h4>
            <p class="text-sm text-gray-300 mb-3">Restore matches from a backup file</p>
            <input type="file" id="import-file-input" accept=".json" class="hidden" />
            <button id="select-import-file-btn" class="w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded mb-2">
              Select Import File
            </button>
            <button id="import-data-btn" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded hidden">
              Import Matches
            </button>
            <div id="import-status" class="text-sm text-gray-400"></div>
          </div>
          
          <!-- Storage Info -->
          <div>
            <h4 class="font-semibold mb-2">Storage Information</h4>
            <div id="storage-info" class="text-sm text-gray-300">
              <div>Loading storage info...</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Match Statistics Modal -->
      <div id="match-stats-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-gray-800 text-gray-100 border border-gray-700 w-11/12 max-w-2xl max-h-[80vh] flex flex-col">
          <!-- Sticky Header -->
          <div class="flex-shrink-0 sticky top-0 bg-gray-800 border-b border-gray-700">
            <div class="flex justify-between items-center p-4">
              <h3 class="text-lg font-bold">Match Statistics</h3>
              <div class="flex items-center space-x-2">
                <button id="close-stats-modal-btn" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2">Close</button>
              </div>
            </div>
          </div>
          
          <!-- Scrollable Content -->
          <div class="flex-1 overflow-y-auto p-4">
            <!-- Team Scorers Cards -->
            <div id="stats-scorers-cards" class="space-y-4"></div>
          </div>
        </div>
      </div>

        <!-- Edit players view -->
      <section id="edit-players-view" class="view" style="display: none;">
        <!-- Top bar for player editing: Cancel on the left, title centred, Done on the right -->
        <div class="flex justify-between items-center my-2">
          <button id="cancel-players-btn" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Cancel">Cancel</button>
          <h2 class="text-lg font-semibold">Edit Players</h2>
          <button id="save-players-btn" class="primary-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2" title="Done">Done</button>
        </div>
        <!-- Container for the editable list of players.  Sections for each team will be inserted here dynamically. -->
        <div id="players-edit-container" class="players-edit-container space-y-4"></div>
      </section>
    </main>
    <script src="script.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => {
              console.log('SW registered: ', registration);
            })
            .catch(registrationError => {
              console.log('SW registration failed: ', registrationError);
            });
        });
      }
    </script>
  </body>
</html>